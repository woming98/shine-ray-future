import{c as V,r as b,j as e,m as A,B as z}from"./index-BMvr2Q3z.js";import{s as B}from"./s1-reading-BZMNVTMq.js";import{I as R}from"./info-5zt1hSyq.js";import{B as w,C as v}from"./Button-pqDR0Cbl.js";import{u as I}from"./useStore-BLrCrgBZ.js";import{C as H}from"./check-circle-C5mn4RTd.js";import{X as W}from"./x-circle-DC3krgu5.js";import{C as D}from"./clock-CHSnmCTT.js";import{C as O}from"./chevron-left-CuOLKypr.js";import{C as X}from"./chevron-right-AIw1T69N.js";import"./middleware-dtXbDlhF.js";import"./useGlobalUser-DSzfZyT8.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=V("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function F({text:m,onWordClick:c,selectedWord:r}){const[x,l]=b.useState(null),u=m.split(/(\s+|[.,!?;:])/),o=new Set(["significant","important","develop","enhance","comprehend","analyze","evaluate","demonstrate","illustrate","examine"]),f=d=>{const n=d.toLowerCase().replace(/[.,!?;:]/g,"");n.length>4&&o.has(n)&&(c==null||c(n))};return e.jsx("p",{className:"text-gray-800 leading-relaxed text-lg",children:u.map((d,n)=>{const j=d.toLowerCase().replace(/[.,!?;:]/g,""),S=j.length>4&&o.has(j),p=r===j,g=x===j;return S?e.jsx(A.span,{className:`inline-block cursor-pointer px-1 rounded transition-colors ${p?"bg-emerald-500 text-white":g?"bg-emerald-200 text-emerald-900":"bg-emerald-100/50 text-emerald-800 hover:bg-emerald-200"}`,onMouseEnter:()=>l(j),onMouseLeave:()=>l(null),onClick:()=>f(j),whileHover:{scale:1.05},whileTap:{scale:.95},children:d},n):e.jsx("span",{children:d},n)})})}function G({sentence:m}){const r=(x=>{const l=/(because|although|when|if|that|which|who|where)/i.test(x),u=/(and|but|or|so|yet)/i.test(x),o=/\b(was|were|is|are|been)\s+\w+ed\b/i.test(x);return{hasSubordinateClause:l,hasCoordination:u,hasPassive:o,structure:l?"复合句":u?"并列句":"简单句"}})(m);return e.jsx(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(R,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-blue-900 mb-2",children:"句子结构分析"}),e.jsx("p",{className:"text-gray-800 mb-3 italic",children:m}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-blue-900",children:"句子类型："}),e.jsx("span",{className:"text-gray-700 ml-2",children:r.structure})]}),r.hasSubordinateClause&&e.jsx("div",{className:"text-sm text-gray-700",children:"• 包含从句结构"}),r.hasCoordination&&e.jsx("div",{className:"text-sm text-gray-700",children:"• 包含并列结构"}),r.hasPassive&&e.jsx("div",{className:"text-sm text-gray-700",children:"• 使用被动语态"})]})]})]})})}function J({passage:m,onWordClick:c}){const[r,x]=b.useState(null),[l,u]=b.useState(null),{addToVocabularyBook:o}=I(),f=n=>{x(n),u(null),c==null||c(n)},d=n=>{o({id:`vocab-${n}-${Date.now()}`,word:n,partOfSpeech:"unknown",definitions:[{meaning:"点击查看定义",example:""}],difficulty:"medium"}),x(null)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-emerald-200 shadow-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:m.title}),e.jsx("div",{className:"prose prose-emerald max-w-none",children:e.jsx(F,{text:m.passage,onWordClick:f,selectedWord:r})})]}),r&&e.jsx(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-emerald-50 border border-emerald-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-emerald-900 mb-2",children:["词汇：",r]}),e.jsx("p",{className:"text-gray-700 text-sm",children:'点击"添加到词汇本"保存这个单词'})]}),e.jsx(w,{size:"sm",icon:e.jsx(K,{className:"w-4 h-4"}),onClick:()=>d(r),children:"添加到词汇本"})]})}),l&&e.jsx(G,{sentence:l})]})}function ie(){const[m,c]=b.useState("reading"),[r,x]=b.useState(0),[l,u]=b.useState(0),[o,f]=b.useState({}),[d,n]=b.useState(20*60),{addPracticeRecord:j,recordDailyStudy:S}=I(),p=B,g=p[r],i=g==null?void 0:g.questions[l],y=p.flatMap(s=>s.questions);b.useEffect(()=>{if(m!=="testing"||d<=0)return;const s=setInterval(()=>{n(t=>t<=1?(c("result"),0):t-1)},1e3);return()=>clearInterval(s)},[m,d]);const M=s=>{const t=Math.floor(s/60),a=s%60;return`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},k=(s,t)=>{f(a=>({...a,[s]:t}))},P=()=>{l<g.questions.length-1?u(s=>s+1):r<p.length-1&&(x(s=>s+1),u(0))},E=()=>{l>0?u(s=>s-1):r>0&&(x(s=>s-1),u(p[r-1].questions.length-1))},L=()=>{c("testing"),n(20*60),f({})},T=()=>{c("result"),y.forEach(s=>{const t=o[s.id],a=Array.isArray(s.answer)?s.answer.map(h=>h.toLowerCase()).includes(t==null?void 0:t.toLowerCase()):(t==null?void 0:t.toLowerCase())===s.answer.toLowerCase();j({questionId:s.id,skill:"reading",userAnswer:t||"",isCorrect:a,timeSpent:Math.floor((20*60-d)/y.length),topic:"reading",subtopic:"reading-main-idea"})}),S({minutes:Math.floor((20*60-d)/60),exercisesCompleted:y.length,skillsStudied:["reading"]})},$=()=>{let s=0;return y.forEach(t=>{var C;const a=(C=o[t.id])==null?void 0:C.toLowerCase();(Array.isArray(t.answer)?t.answer.map(N=>N.toLowerCase()):[t.answer.toLowerCase()]).includes(a)&&s++}),{correct:s,total:y.length,percentage:Math.round(s/y.length*100)}};if(m==="reading")return e.jsx("div",{className:"space-y-6",children:e.jsxs(v,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(z,{className:"w-6 h-6 text-emerald-600"}),"智能阅读理解"]}),e.jsx(w,{onClick:L,children:"开始练习"})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"选择一篇文章开始阅读练习。点击文章中的高亮词汇可以查看定义并添加到词汇本。"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map((s,t)=>e.jsxs(v,{onClick:()=>{x(t),L()},className:"cursor-pointer hover:shadow-md transition-shadow",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["难度：",s.difficulty]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.questions.length," 道题目"]})]},s.id))})]})});if(m==="result"){const s=$();return e.jsx("div",{className:"space-y-6",children:e.jsxs(v,{className:"p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"text-6xl font-bold text-emerald-600 mb-2",children:[s.percentage,"%"]}),e.jsxs("div",{className:"text-gray-600",children:["答对 ",s.correct," / ",s.total," 题"]})]}),e.jsx("div",{className:"space-y-4",children:p.map(t=>e.jsxs("div",{className:"border border-emerald-200 rounded-xl p-4 bg-emerald-50",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:t.title}),t.questions.map(a=>{const h=o[a.id],C=Array.isArray(a.answer)?a.answer[0]:a.answer,N=Array.isArray(a.answer)?a.answer.map(Q=>Q.toLowerCase()).includes(h==null?void 0:h.toLowerCase()):(h==null?void 0:h.toLowerCase())===a.answer.toLowerCase();return e.jsx("div",{className:"py-3 border-t border-emerald-200",children:e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[N?e.jsx(H,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}):e.jsx(W,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-2",children:a.question}),e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["你的答案：",e.jsx("span",{className:N?"text-green-600":"text-red-600",children:h||"未作答"})]}),!N&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["正确答案：",e.jsx("span",{className:"text-green-600",children:C})]}),e.jsx("p",{className:"text-sm text-emerald-700 bg-emerald-100 p-2 rounded",children:a.explanation})]})]})},a.id)})]},t.id))}),e.jsxs("div",{className:"mt-6 flex gap-4 justify-center",children:[e.jsx(w,{onClick:()=>{c("reading")},children:"返回"}),e.jsx(w,{onClick:L,children:"重新练习"})]})]})})}return e.jsxs("div",{className:"space-y-6",children:[e.jsx(v,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-emerald-600"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:M(d)})]}),e.jsx(w,{variant:"secondary",onClick:T,children:"提交答案"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(J,{passage:g})}),e.jsxs(v,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-bold text-gray-900",children:["题目 ",l+1," / ",g.questions.length]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:E,disabled:l===0&&r===0,className:"p-2 rounded-lg hover:bg-emerald-100 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(O,{className:"w-5 h-5"})}),e.jsx("button",{onClick:P,disabled:l===g.questions.length-1&&r===p.length-1,className:"p-2 rounded-lg hover:bg-emerald-100 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(X,{className:"w-5 h-5"})})]})]}),i&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-900 font-medium",children:i.question}),i.type==="choice"&&i.options&&e.jsx("div",{className:"space-y-2",children:i.options.map((s,t)=>{const a=String.fromCharCode(65+t),h=o[i.id]===s;return e.jsxs("button",{onClick:()=>k(i.id,s),className:`w-full text-left p-3 rounded-lg border-2 transition-all ${h?"border-emerald-500 bg-emerald-50 text-emerald-900":"border-gray-200 hover:border-emerald-300 hover:bg-emerald-50"}`,children:[e.jsxs("span",{className:"font-medium",children:[a,". "]}),s]},t)})}),i.type==="fill"&&e.jsx("input",{type:"text",value:o[i.id]||"",onChange:s=>k(i.id,s.target.value),className:"w-full p-3 border-2 border-gray-200 rounded-lg focus:border-emerald-500 focus:outline-none",placeholder:"请输入答案"}),i.type==="true-false"&&i.options&&e.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.options.map(s=>{const t=o[i.id]===s;return e.jsx("button",{onClick:()=>k(i.id,s),className:`p-3 rounded-lg border-2 transition-all ${t?"border-emerald-500 bg-emerald-50 text-emerald-900":"border-gray-200 hover:border-emerald-300 hover:bg-emerald-50"}`,children:s},s)})})]})]})]})]})}export{ie as default};

import{c as k,p as y}from"./middleware-dtXbDlhF.js";import{u as S}from"./useGlobalUser-DSzfZyT8.js";const C=[{id:"english-first-step",title:"First Step",titleCN:"åˆæ¬¡æŽ¢ç´¢",description:"å®Œæˆç¬¬ä¸€ä¸ªè‹±æ–‡æŠ€èƒ½çš„å­¦ä¹ ",icon:"ðŸŽ¯",category:"learning",requirement:1},{id:"english-reading-master",title:"Reading Master",titleCN:"é–±è®€é”äºº",description:"å®Œæˆ50ç¯‡é˜…è¯»ç†è§£ç»ƒä¹ ",icon:"ðŸ“–",category:"practice",requirement:50},{id:"english-writing-expert",title:"Writing Expert",titleCN:"å¯«ä½œé«˜æ‰‹",description:"å®Œæˆ20ç¯‡å†™ä½œå¹¶èŽ·å¾—å¹³å‡åˆ†15åˆ†ä»¥ä¸Š",icon:"âœï¸",category:"practice",requirement:20},{id:"english-listening-pro",title:"Listening Pro",titleCN:"è†è½å°ˆå®¶",description:"å®Œæˆ30ä¸ªå¬åŠ›ç»ƒä¹ ",icon:"ðŸŽ§",category:"practice",requirement:30},{id:"english-speaking-fluent",title:"Fluent Speaker",titleCN:"å£èªžæµåˆ©",description:"å®Œæˆ20æ¬¡å£è¯­ç»ƒä¹ ",icon:"ðŸŽ¤",category:"practice",requirement:20},{id:"english-vocabulary-master",title:"Vocabulary Master",titleCN:"è©žå½™å¤§å¸«",description:"æŽŒæ¡500ä¸ªå•è¯",icon:"ðŸ“š",category:"learning",requirement:500},{id:"english-perfect-score",title:"Perfect Score",titleCN:"æ»¿åˆ†é”æˆ",description:"åœ¨ç»ƒä¹ ä¸­èŽ·å¾—æ»¡åˆ†",icon:"ðŸ†",category:"challenge",requirement:1},{id:"english-skill-complete",title:"Skill Master",titleCN:"æŠ€èƒ½ç²¾é€š",description:"å®Œæˆä¸€ä¸ªå®Œæ•´æŠ€èƒ½çš„å­¦ä¹ ",icon:"ðŸŽ“",category:"learning",requirement:1},{id:"english-week-streak",title:"Weekly Warrior",titleCN:"å‘¨å­¸ç¿’é”äºº",description:"è¿žç»­å­¦ä¹ 7å¤©",icon:"ðŸ”¥",category:"challenge",requirement:7},{id:"english-ai-writer",title:"AI Writer",titleCN:"AIå¯«ä½œé”äºº",description:"ä½¿ç”¨ AI æ‰¹æ”¹å®Œæˆ10ç¯‡å†™ä½œ",icon:"ðŸ¤–",category:"special",requirement:10}],w=[{id:"reading",name:"Reading",nameCN:"é–±è®€ç†è§£",icon:"ðŸ“–",description:"æå‡é˜…è¯»ç†è§£èƒ½åŠ›ï¼ŒæŽŒæ¡å„ç§é¢˜åž‹æŠ€å·§",subtopics:[{id:"reading-main-idea",name:"Main Idea",nameCN:"ä¸»æ—¨å¤§æ„",description:"ç†è§£æ–‡ç« çš„ä¸»è¦è§‚ç‚¹å’Œä¸­å¿ƒæ€æƒ³"},{id:"reading-detail",name:"Detail Questions",nameCN:"ç´°ç¯€ç†è§£",description:"æ‰¾å‡ºæ–‡ç« ä¸­çš„å…·ä½“ä¿¡æ¯å’Œç»†èŠ‚"},{id:"reading-inference",name:"Inference",nameCN:"æŽ¨ç†åˆ¤æ–·",description:"æ ¹æ®æ–‡ç« å†…å®¹è¿›è¡ŒæŽ¨ç†å’Œåˆ¤æ–­"},{id:"reading-vocabulary",name:"Vocabulary in Context",nameCN:"è©žå½™ç†è§£",description:"æ ¹æ®ä¸Šä¸‹æ–‡ç†è§£è¯æ±‡å«ä¹‰"},{id:"reading-summary",name:"Summary",nameCN:"æ‘˜è¦å¡«ç©º",description:"ç†è§£æ–‡ç« ç»“æž„ï¼Œå®Œæˆæ‘˜è¦å¡«ç©º"}]},{id:"writing",name:"Writing",nameCN:"å¯«ä½œ",icon:"âœï¸",description:"æŽŒæ¡å„ç§å†™ä½œä½“è£ï¼Œæå‡å†™ä½œæŠ€å·§",subtopics:[{id:"writing-essay",name:"Essay Writing",nameCN:"è­°è«–æ–‡",description:"å­¦ä¹ è®®è®ºæ–‡çš„ç»“æž„å’Œå†™ä½œæŠ€å·§"},{id:"writing-letter",name:"Letter Writing",nameCN:"æ›¸ä¿¡",description:"æŽŒæ¡æ­£å¼å’Œéžæ­£å¼ä¹¦ä¿¡çš„æ ¼å¼"},{id:"writing-report",name:"Report Writing",nameCN:"å ±å‘Š",description:"å­¦ä¹ æŠ¥å‘Šçš„å†™ä½œç»“æž„å’Œè¯­è¨€ç‰¹ç‚¹"},{id:"writing-article",name:"Article Writing",nameCN:"æ–‡ç« ",description:"æŽŒæ¡æ–‡ç« å†™ä½œçš„æŠ€å·§å’Œé£Žæ ¼"},{id:"writing-story",name:"Story Writing",nameCN:"æ•…äº‹",description:"å­¦ä¹ æ•…äº‹å†™ä½œçš„è¦ç´ å’ŒæŠ€å·§"}]},{id:"listening",name:"Listening",nameCN:"è†è½",icon:"ðŸŽ§",description:"æå‡å¬åŠ›ç†è§£èƒ½åŠ›ï¼ŒæŽŒæ¡ç»¼åˆæŠ€èƒ½",subtopics:[{id:"listening-main-idea",name:"Main Idea",nameCN:"ä¸»æ—¨ç†è§£",description:"ç†è§£å¬åŠ›ææ–™çš„ä¸»è¦è§‚ç‚¹"},{id:"listening-detail",name:"Detail Information",nameCN:"ç´°ç¯€ä¿¡æ¯",description:"æ•æ‰å¬åŠ›ææ–™ä¸­çš„å…·ä½“ä¿¡æ¯"},{id:"listening-data-file",name:"Data File",nameCN:"è³‡æ–™è™•ç†",description:"å¤„ç† Data Fileï¼Œæ•´åˆä¿¡æ¯"},{id:"listening-note-taking",name:"Note-taking",nameCN:"ç­†è¨˜æŠ€å·§",description:"å­¦ä¹ æœ‰æ•ˆçš„ç¬”è®°æŠ€å·§"}]},{id:"speaking",name:"Speaking",nameCN:"å£èªž",icon:"ðŸŽ¤",description:"æå‡å£è¯­è¡¨è¾¾èƒ½åŠ›å’Œå‘éŸ³å‡†ç¡®æ€§",subtopics:[{id:"speaking-group",name:"Group Discussion",nameCN:"å°çµ„è¨Žè«–",description:"å­¦ä¹ å°ç»„è®¨è®ºçš„æŠ€å·§å’Œç­–ç•¥"},{id:"speaking-individual",name:"Individual Response",nameCN:"å€‹äººå›žæ‡‰",description:"æå‡ä¸ªäººå›žåº”é—®é¢˜çš„èƒ½åŠ›"},{id:"speaking-presentation",name:"Presentation",nameCN:"æ¼”è¬›",description:"å­¦ä¹ æ¼”è®²çš„ç»“æž„å’Œè¡¨è¾¾æŠ€å·§"},{id:"speaking-pronunciation",name:"Pronunciation",nameCN:"ç™¼éŸ³",description:"æ”¹å–„å‘éŸ³å‡†ç¡®æ€§å’Œæµæš¢åº¦"}]}],h=k()(y((o,a)=>{const u=()=>{var e;return((e=S.getState().user)==null?void 0:e.id)||"anonymous"};return{practiceRecords:[],addPracticeRecord:e=>{const i=u(),r={...e,id:`pr-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,userId:i};o(n=>({practiceRecords:[...n.practiceRecords,r]}));const t=a().stats;if(a().updateStats({exercisesSolved:t.exercisesSolved+1,averageScore:e.isCorrect?Math.round((t.averageScore*t.exercisesSolved+100)/(t.exercisesSolved+1)):Math.round(t.averageScore*t.exercisesSolved/(t.exercisesSolved+1))}),e.isCorrect||a().addErrorLog(e.questionId,e.skill,e.topic,e.subtopic),e.isCorrect){const n=a().skillProgress[e.skill]||0;a().updateSkillProgress(e.skill,Math.min(100,n+1))}},errorLogs:[],addErrorLog:(e,i,r,t)=>{const n=u(),c=a().errorLogs.find(l=>l.questionId===e&&l.userId===n&&l.skill===i);o(c?l=>({errorLogs:l.errorLogs.map(m=>m.id===c.id?{...m,errorCount:m.errorCount+1,lastErrorTime:new Date}:m)}):l=>({errorLogs:[...l.errorLogs,{id:`el-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,userId:n,questionId:e,skill:i,errorCount:1,lastErrorTime:new Date,mastered:!1,topic:r,subtopic:t}]}))},markAsMastered:e=>{o(i=>({errorLogs:i.errorLogs.map(r=>r.id===e?{...r,mastered:!0}:r)}))},skillProgress:{},updateSkillProgress:(e,i)=>{o(r=>({skillProgress:{...r.skillProgress,[e]:Math.max(0,Math.min(100,i))}}))},vocabularyBook:null,addToVocabularyBook:e=>{const i=u(),r=a().vocabularyBook;!r||r.userId!==i?o({vocabularyBook:{userId:i,words:[{wordId:e.id,addedAt:new Date,mastered:!1,reviewCount:0}]}}):r.words.find(n=>n.wordId===e.id)||o({vocabularyBook:{...r,words:[...r.words,{wordId:e.id,addedAt:new Date,mastered:!1,reviewCount:0}]}})},removeFromVocabularyBook:e=>{const i=a().vocabularyBook;i&&o({vocabularyBook:{...i,words:i.words.filter(r=>r.wordId!==e)}})},markWordAsMastered:e=>{const i=a().vocabularyBook;i&&o({vocabularyBook:{...i,words:i.words.map(r=>r.wordId===e?{...r,mastered:!0}:r)}})},reviewWord:e=>{const i=a().vocabularyBook;i&&o({vocabularyBook:{...i,words:i.words.map(r=>r.wordId===e?{...r,reviewCount:r.reviewCount+1,lastReview:new Date}:r)}})},essaySubmissions:[],addEssaySubmission:(e,i,r=null)=>{const t=u();o(n=>({essaySubmissions:[...n.essaySubmissions,{id:`essay-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,userId:t,taskId:e,essay:i,score:r,submittedAt:new Date}]}))},speakingRecordings:[],addSpeakingRecording:e=>{const i=u();o(r=>({speakingRecordings:[...r.speakingRecordings,{...e,id:`rec-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,userId:i,timestamp:new Date}]}))},updateRecordingEvaluation:(e,i)=>{o(r=>({speakingRecordings:r.speakingRecordings.map(t=>t.id===e?{...t,evaluation:i}:t)}))},getRecommendedQuestions:(e,i)=>a().errorLogs.filter(n=>!n.mastered&&n.userId===u()&&n.skill===e).sort((n,c)=>c.errorCount-n.errorCount).slice(0,Math.floor(i/2)).map(n=>n.questionId),getEnglishReport:()=>{const e=u(),i=a().practiceRecords.filter(s=>s.userId===e),r=a().errorLogs.filter(s=>s.userId===e),t={};i.forEach(s=>{t[s.skill]||(t[s.skill]={correct:0,total:0,time:0}),t[s.skill].total++,t[s.skill].time+=s.timeSpent,s.isCorrect&&t[s.skill].correct++});const n={Reading:0,Writing:0,Listening:0,Speaking:0};w.forEach(s=>{const d=t[s.id];if(d&&d.total>0){const p=Math.round(d.correct/d.total*100);n[s.name]=p}});const c={};r.forEach(s=>{const d=`${s.skill}-${s.topic||"unknown"}`;c[d]=(c[d]||0)+s.errorCount});const m=a().dailyStudy.slice(-7).map(s=>({date:s.date,score:s.exercisesCompleted>0?Math.round(s.exercisesCompleted/10*100):0})),g={};return Object.entries(t).forEach(([s,d])=>{g[s]={correctRate:d.total>0?Math.round(d.correct/d.total*100):0,averageTime:d.total>0?Math.round(d.time/d.total):0,totalQuestions:d.total}}),{userId:e,radarData:n,skillStats:g,errorDistribution:c,progressTrend:m}},achievements:C.map(e=>({...e,progress:0,unlocked:!1})),unlockAchievement:e=>{const i=a().achievements.map(r=>r.id===e?{...r,unlocked:!0,unlockedAt:new Date}:r);o({achievements:i})},updateAchievementProgress:(e,i)=>{const r=a().achievements.map(t=>t.id===e?{...t,progress:i,unlocked:i>=t.requirement,unlockedAt:i>=t.requirement?new Date:t.unlockedAt}:t);o({achievements:r})},stats:{totalStudyTime:0,skillsCompleted:0,exercisesSolved:0,averageScore:0,currentStreak:0,longestStreak:0,weeklyGoal:300,weeklyProgress:0},updateStats:e=>{o({stats:{...a().stats,...e}})},addStudyTime:e=>{const{stats:i}=a();o({stats:{...i,totalStudyTime:i.totalStudyTime+e,weeklyProgress:i.weeklyProgress+e}})},dailyStudy:[],recordDailyStudy:e=>{const i=new Date().toISOString().split("T")[0];if(a().dailyStudy.find(t=>t.date===i)){const t=a().dailyStudy.map(n=>n.date===i?{...n,minutes:n.minutes+e.minutes,exercisesCompleted:n.exercisesCompleted+e.exercisesCompleted,skillsStudied:[...new Set([...n.skillsStudied,...e.skillsStudied])]}:n);o({dailyStudy:t})}else o({dailyStudy:[...a().dailyStudy,{date:i,...e}]})},sidebarOpen:!0,toggleSidebar:()=>o({sidebarOpen:!a().sidebarOpen}),currentSkill:null,setCurrentSkill:e=>o({currentSkill:e})}},{name:"dse-english-storage",partialize:o=>({practiceRecords:o.practiceRecords,errorLogs:o.errorLogs,skillProgress:o.skillProgress,vocabularyBook:o.vocabularyBook,essaySubmissions:o.essaySubmissions,speakingRecordings:o.speakingRecordings,achievements:o.achievements,stats:o.stats,dailyStudy:o.dailyStudy})}));export{w as E,h as u};

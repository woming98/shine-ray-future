import{r as n,j as e,B as b,m as f}from"./index-BMvr2Q3z.js";import{u as N}from"./useStore-BLrCrgBZ.js";import{C as k,B as w}from"./Button-pqDR0Cbl.js";import{F as v}from"./filter-BnXij0ur.js";import{C as x}from"./check-circle-C5mn4RTd.js";import"./middleware-dtXbDlhF.js";import"./useGlobalUser-DSzfZyT8.js";function I(){const{errorLogs:i,markAsMastered:d,practiceRecords:g}=N(),[a,c]=n.useState("all"),[l,p]=n.useState(!1),r=n.useMemo(()=>{let s=i.filter(t=>l||!t.mastered);return a!=="all"&&(s=s.filter(t=>t.skill===a)),s.sort((t,o)=>o.errorCount-t.errorCount)},[i,a,l]),h=["reading","writing","listening","speaking","grammar","vocabulary"],u=(s,t)=>g.find(m=>m.questionId===s&&m.skill===t),y=s=>{d(s)},j=s=>({reading:"bg-blue-100 text-blue-700",writing:"bg-purple-100 text-purple-700",listening:"bg-green-100 text-green-700",speaking:"bg-orange-100 text-orange-700",grammar:"bg-yellow-100 text-yellow-700",vocabulary:"bg-pink-100 text-pink-700"})[s]||"bg-gray-100 text-gray-700";return e.jsx("div",{className:"space-y-6",children:e.jsxs(k,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(b,{className:"w-6 h-6 text-emerald-600"}),"错题本"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-sm text-gray-600",children:["共 ",r.length," 道错题"]})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"筛选："})]}),e.jsx("button",{onClick:()=>c("all"),className:`px-3 py-1 rounded-lg text-sm transition-colors ${a==="all"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"全部"}),h.map(s=>e.jsx("button",{onClick:()=>c(s),className:`px-3 py-1 rounded-lg text-sm transition-colors ${a===s?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s},s)),e.jsxs("label",{className:"flex items-center gap-2 ml-auto",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:s=>p(s.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:"显示已掌握"})]})]}),r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(x,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"太棒了！没有错题需要复习。"})]}):e.jsx("div",{className:"space-y-4",children:r.map(s=>{const t=u(s.questionId,s.skill);return e.jsx(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${j(s.skill)}`,children:s.skill}),s.mastered&&e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700",children:"已掌握"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["错误 ",s.errorCount," 次"]})]}),e.jsxs("p",{className:"text-gray-900 font-medium mb-2",children:["题目 ID: ",s.questionId]}),t&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["你的答案：",t.userAnswer]}),s.topic&&e.jsxs("p",{className:"text-xs text-gray-500",children:["主题：",s.topic," ",s.subtopic&&`- ${s.subtopic}`]})]}),!s.mastered&&e.jsx(w,{size:"sm",variant:"secondary",onClick:()=>y(s.id),icon:e.jsx(x,{className:"w-4 h-4"}),children:"标记已掌握"})]})},s.id)})})]})})}export{I as default};
